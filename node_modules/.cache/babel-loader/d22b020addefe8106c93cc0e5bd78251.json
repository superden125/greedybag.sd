{"ast":null,"code":"import _toConsumableArray from\"/home/sd/HK1-2020-2021/NLCS/balo/demo2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/sd/HK1-2020-2021/NLCS/balo/demo2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/sd/HK1-2020-2021/NLCS/balo/demo2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from\"react\";import classNames from\"classnames\";import*as XLSX from\"xlsx\";import*as FileSaver from\"file-saver\";import{FormGroup,Input,Label,Button}from\"reactstrap\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";export default function InputFile(props){var setFileName=props.setFileName,fileNames=props.fileNames,setIsLoading=props.setIsLoading,setInputFile=props.setInputFile,totalWeight=props.totalWeight,totalValue=props.totalValue,file=props.file,setFile=props.setFile,items=props.items,isGreedy=props.isGreedy,inputWeight=props.inputWeight,type=props.type,disabled=props.disabled;var fileUpload=React.useRef(null);var getExtFile=function getExtFile(filename){var last_dot=filename.lastIndexOf(\".\");return filename.slice(last_dot+1);};var readFileTxt=function readFileTxt(reader){var items=[];reader.onload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var text,weight;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);console.log(\"load\");text=e.target.result.split(/\\r\\n|\\n/);weight=parseInt(text[0]);text.forEach(function(line,index){//console.log(line);\nif(index!==0){var cell=line.split(\" \");var stock=cell[2]%1===0?cell[2]:\"\";var name=\"\";if(stock!==\"\"){cell.slice(3).forEach(function(t){name+=t+\" \";});}else{cell.slice(2).forEach(function(t){name+=t+\" \";});}items.push({name:name.trim(),value:cell[0],weight:cell[1],stock:stock,qty:\"\"});}});console.log(items);setInputFile(weight,items);setIsLoading(false);case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();//reader.readAsText(e.target.files[0]);\n};var readFileXlsx=function readFileXlsx(reader){var items=[];reader.onload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var bstr,wb,wsname,ws,data,i;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setIsLoading(true);/* Parse data */bstr=e.target.result;wb=XLSX.read(bstr,{type:\"binary\"});/* Get first worksheet */wsname=wb.SheetNames[0];ws=wb.Sheets[wsname];/* Convert array of arrays */data=XLSX.utils.sheet_to_json(ws,{header:1});/* Update state */ // console.log(data);\nfor(i=1;i<data.length;i++){items.push({name:data[i][0].trim(),value:data[i][1],weight:data[i][2],stock:data[i][3]%1===0?data[i][3]:\"\",qty:\"\"});}setInputFile(0,items);setIsLoading(false);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};var readFile=function readFile(e){if(e!==undefined){if(e.target.files[0]!==undefined){e.preventDefault();var reader=new FileReader();var ext=getExtFile(e.target.files[0].name);setFileName(e.target.files[0].name);setFile(e.target.value);switch(ext){case\"txt\":readFileTxt(reader);break;case\"xlsx\":readFileXlsx(reader);break;default:break;}ext===\"xlsx\"&&reader.readAsBinaryString(e.target.files[0]);ext===\"txt\"&&reader.readAsText(e.target.files[0]);}}};var exportToCSV=function exportToCSV(items,fileName){var csvData=_toConsumableArray(items);var ttValue=totalValue(csvData);var ttWeight=totalWeight(csvData);csvData.push({name:\"Input Weight:\",value:inputWeight,weight:\"Type:\",stock:type});csvData.push({name:\"Total:\",value:ttValue,weight:ttWeight});var fileType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";var fileExtension=\".xlsx\";var ws=XLSX.utils.json_to_sheet(csvData);var wb={Sheets:{data:ws},SheetNames:[\"data\"]};var excelBuffer=XLSX.write(wb,{bookType:\"xlsx\",type:\"array\"});var data=new Blob([excelBuffer],{type:fileType});FileSaver.saveAs(data,fileName+fileExtension);};return/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"legend\",null,\"File\"),/*#__PURE__*/React.createElement(Label,{for:\"file\",className:classNames(\"sd-file-choose sd-btn btn btn-primary\",{disabled:disabled})},/*#__PURE__*/React.createElement(\"span\",{className:\"sd-file-upload\"},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:\"file-upload\",className:\"sd-icon\"}),\"Th\\xEAm File\")),/*#__PURE__*/React.createElement(Input,{type:\"file\",name:\"file\",id:\"file\",onChange:function onChange(e){return readFile(e);},style:{display:\"none\"},value:file||\"\",disabled:disabled,ref:fileUpload}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Label,null,fileNames),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Button,{className:\"sd-file-choose sd-btn btn btn-danger\",onClick:function onClick(){return exportToCSV(items,\"result\");},disabled:!isGreedy},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:\"file-download\",className:\"sd-icon\"}),\"Xu\\u1EA5t file\"));}","map":{"version":3,"sources":["/home/sd/HK1-2020-2021/NLCS/balo/demo2/src/components/Items/InputFile.js"],"names":["React","classNames","XLSX","FileSaver","FormGroup","Input","Label","Button","FontAwesomeIcon","InputFile","props","setFileName","fileNames","setIsLoading","setInputFile","totalWeight","totalValue","file","setFile","items","isGreedy","inputWeight","type","disabled","fileUpload","useRef","getExtFile","filename","last_dot","lastIndexOf","slice","readFileTxt","reader","onload","e","console","log","text","target","result","split","weight","parseInt","forEach","line","index","cell","stock","name","t","push","trim","value","qty","readFileXlsx","bstr","wb","read","wsname","SheetNames","ws","Sheets","data","utils","sheet_to_json","header","i","length","readFile","undefined","files","preventDefault","FileReader","ext","readAsBinaryString","readAsText","exportToCSV","fileName","csvData","ttValue","ttWeight","fileType","fileExtension","json_to_sheet","excelBuffer","write","bookType","Blob","saveAs","display"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport classNames from \"classnames\";\nimport * as XLSX from \"xlsx\";\nimport * as FileSaver from \"file-saver\";\nimport { FormGroup, Input, Label, Button } from \"reactstrap\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nexport default function InputFile(props) {\n  const {\n    setFileName,\n    fileNames,\n    setIsLoading,\n    setInputFile,\n    totalWeight,\n    totalValue,\n    file,\n    setFile,\n    items,\n    isGreedy,\n    inputWeight,\n    type,\n    disabled,\n  } = props;\n\n  const fileUpload = React.useRef(null);\n\n  const getExtFile = (filename) => {\n    let last_dot = filename.lastIndexOf(\".\");\n    return filename.slice(last_dot + 1);\n  };\n\n  const readFileTxt = (reader) => {\n    const items = [];\n\n    reader.onload = async (e) => {\n      setIsLoading(true);\n      console.log(\"load\");\n      const text = e.target.result.split(/\\r\\n|\\n/);\n      let weight = parseInt(text[0]);\n      text.forEach((line, index) => {\n        //console.log(line);\n        if (index !== 0) {\n          const cell = line.split(\" \");\n\n          const stock = cell[2] % 1 === 0 ? cell[2] : \"\";\n          let name = \"\";\n          if (stock !== \"\") {\n            cell.slice(3).forEach((t) => {\n              name += t + \" \";\n            });\n          } else {\n            cell.slice(2).forEach((t) => {\n              name += t + \" \";\n            });\n          }\n          items.push({\n            name: name.trim(),\n            value: cell[0],\n            weight: cell[1],\n            stock: stock,\n            qty: \"\",\n          });\n        }\n      });\n      console.log(items);\n      setInputFile(weight, items);\n\n      setIsLoading(false);\n    };\n    //reader.readAsText(e.target.files[0]);\n  };\n\n  const readFileXlsx = (reader) => {\n    const items = [];\n    reader.onload = async (e) => {\n      setIsLoading(true);\n\n      /* Parse data */\n      const bstr = e.target.result;\n      const wb = XLSX.read(bstr, { type: \"binary\" });\n      /* Get first worksheet */\n      const wsname = wb.SheetNames[0];\n      const ws = wb.Sheets[wsname];\n      /* Convert array of arrays */\n      const data = XLSX.utils.sheet_to_json(ws, { header: 1 });\n      /* Update state */\n      // console.log(data);\n\n      for (let i = 1; i < data.length; i++) {\n        items.push({\n          name: data[i][0].trim(),\n          value: data[i][1],\n          weight: data[i][2],\n          stock: data[i][3] % 1 === 0 ? data[i][3] : \"\",\n          qty: \"\",\n        });\n      }\n      setInputFile(0, items);\n      setIsLoading(false);\n    };\n  };\n\n  const readFile = (e) => {\n    if (e !== undefined) {\n      if (e.target.files[0] !== undefined) {\n        e.preventDefault();\n\n        const reader = new FileReader();\n        let ext = getExtFile(e.target.files[0].name);\n        setFileName(e.target.files[0].name);\n        setFile(e.target.value);\n\n        switch (ext) {\n          case \"txt\":\n            readFileTxt(reader);\n            break;\n\n          case \"xlsx\":\n            readFileXlsx(reader);\n            break;\n          default:\n            break;\n        }\n\n        ext === \"xlsx\" && reader.readAsBinaryString(e.target.files[0]);\n        ext === \"txt\" && reader.readAsText(e.target.files[0]);\n      }\n    }\n  };\n\n  const exportToCSV = (items, fileName) => {\n    let csvData = [...items];\n    const ttValue = totalValue(csvData);\n    const ttWeight = totalWeight(csvData);\n    csvData.push({\n      name: \"Input Weight:\",\n      value: inputWeight,\n      weight: \"Type:\",\n      stock: type,\n    });\n    csvData.push({\n      name: \"Total:\",\n      value: ttValue,\n      weight: ttWeight,\n    });\n\n    const fileType =\n      \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\n    const fileExtension = \".xlsx\";\n    const ws = XLSX.utils.json_to_sheet(csvData);\n\n    const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\n    const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n    const data = new Blob([excelBuffer], { type: fileType });\n    FileSaver.saveAs(data, fileName + fileExtension);\n  };\n\n  return (\n    <FormGroup>\n      <legend>File</legend>\n      <Label\n        for=\"file\"\n        className={classNames(\"sd-file-choose sd-btn btn btn-primary\", {\n          disabled: disabled,\n        })}\n      >\n        <span className=\"sd-file-upload\">\n          <FontAwesomeIcon icon=\"file-upload\" className=\"sd-icon\" />\n          Thêm File\n        </span>\n      </Label>\n\n      <Input\n        type=\"file\"\n        name=\"file\"\n        id=\"file\"\n        onChange={(e) => readFile(e)}\n        style={{ display: \"none\" }}\n        value={file || \"\"}\n        disabled={disabled}\n        ref={fileUpload}\n      />\n\n      <br></br>\n      <Label>{fileNames}</Label>\n      <br />\n      <Button\n        className=\"sd-file-choose sd-btn btn btn-danger\"\n        onClick={() => exportToCSV(items, \"result\")}\n        disabled={!isGreedy}\n      >\n        <FontAwesomeIcon icon=\"file-download\" className=\"sd-icon\" />\n        Xuất file\n      </Button>\n    </FormGroup>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}